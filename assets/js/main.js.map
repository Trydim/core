{"version":3,"file":"js/main.js","sources":["webpack://my-webpack-project/./js/main.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst importModuleFunc = async (moduleName) => {\r\n  let link;\r\n  if (moduleName === 'public') {\r\n    link = `${f.SITE_PATH}public/js/${f.PUBLIC_PAGE}.js`;\r\n    moduleName = f.PUBLIC_PAGE;\r\n  } else link = `./module/${moduleName}/${moduleName}.js`;\r\n\r\n  try {\r\n    let importModule = await new Promise((resolve, reject) => {\r\n      import(/* webpackIgnore: true */ link)\r\n        .then(module => resolve(module[moduleName]))\r\n        .catch(err => reject(err));\r\n    });\r\n    return importModule.init() || false;\r\n  } catch (e) { console.log(e); f.showMsg(e, 'error', false); return false; }\r\n}\r\n\r\n//Index.php page\r\nconst initIndex = () => {\r\n  //f.init('');\r\n}\r\n\r\nconst init = (moduleName = 'default') => {\r\n  let module = importModuleFunc(moduleName);\r\n  if (!module) initIndex();\r\n  f.relatedOption();\r\n  return module;\r\n}\r\n\r\nconst setLinkMenu = (page) => {\r\n  for (let n of [...f.qA('a')]) {\r\n    let href = n.getAttribute('href') || '';\r\n    if (href.includes(page) && href.includes('#')) { n.click(); break; }\r\n    else if(href.includes(page)) { n.parentNode.classList.add('active'); break; }\r\n  }\r\n}\r\n\r\nconst cancelFormSubmit = () => {\r\n  f.qA('form', 'keypress', (e) => {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      return false;\r\n    }\r\n  });\r\n}\r\n\r\n// TODO event function\r\n// ---------------------------------------------------------------------------------------------------------------------\r\n\r\nconst authEvent = function(e) {\r\n  let target = e.target,\r\n      action = this.getAttribute('data-action');\r\n\r\n  let select = {\r\n    'exit' : () => {\r\n      location.href = f.SITE_PATH + `?mode=auth&authAction=exit`;\r\n    }\r\n  }\r\n\r\n  select[action]();\r\n};\r\n\r\nconst sideMenuExpanded = (e, node) => {\r\n  e.preventDefault();\r\n  if( node.getAttribute('aria-expanded') === 'true'){\r\n    node.setAttribute('aria-expanded', 'false');\r\n    node.nextElementSibling.classList.add('d-none');\r\n  } else {\r\n    node.setAttribute('aria-expanded', 'true');\r\n    node.nextElementSibling.classList.remove('d-none');\r\n  }\r\n}\r\n\r\n// TODO event bind\r\n// -------------------------------------------------------------------------------------------------------------------\r\n\r\n// Block Authorization\r\nconst onAuthEvent = () => {\r\n  let node = f.gI(f.ID.AUTH_BLOCK);\r\n  node && node.querySelectorAll('[data-action]').forEach(n => n.onclick = authEvent );\r\n}\r\n\r\nconst onClickSubmenu = () => {\r\n  let node = f.qS('#sideMenu a[href^=\"#\"]');\r\n  node && node.addEventListener('click', (e) => sideMenuExpanded(e, node));\r\n}\r\n\r\n// Entrance function\r\n(() => {\r\n  let page = location.pathname.replace(f.SITE_PATH, '').match(/(\\w+)/);\r\n  page = (page && !f.OUTSIDE) ? page[1] : 'public';\r\n\r\n  if (f.gI('authForm')) return;\r\n  cancelFormSubmit();\r\n  onAuthEvent();\r\n  onClickSubmenu();\r\n  f.dictionaryInit();\r\n\r\n  setLinkMenu(page || '/');\r\n  if(page) init(page);\r\n  else initIndex();\r\n\r\n  setTimeout(() => { // todo разобраться с синхронизацией\r\n    f.initShadow(); // todo убрать отсюда\r\n  }, 100);\r\n})();\r\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;A","sourceRoot":""}